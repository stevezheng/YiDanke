<% include ../common_header.html %>
<section id="container" ng-controller="sellerTaskDetailCtrl">
    <% include ./seller_nav.html %>
    <!--main content start-->
    <section id="main-content">
        <section class="wrapper">
            <section class="panel">
                <header class="panel-heading">
                    任务详情
                </header>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-lg-4">
                            <section class="panel">
                                <header class="panel-heading">
                                    任务信息
                                </header>
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <p>
                                                任务总单数: <span class="error">{{task.taskTotalCount}}</span>单
                                            </p>
                                            <p>
                                                电脑端: <span class="error">{{task.taskPcCount}}</span> 单
                                            </p>
                                            <p>
                                                进行中: <span class="error">{{task.taskPcDoingCount}}</span> 单,
                                                未接手: <span class="error">{{task.taskPcCount - task.taskPcDoingCount - task.taskPcDoneCount}}</span> 单,
                                                已完成: <span class="error">{{task.taskPcDoneCount}}</span> 单
                                            </p>
                                            <p>
                                                手机端: <span class="error">{{task.taskPhoneCount}}</span> 单
                                            </p>
                                            <p>
                                                进行中: <span class="error">{{task.taskPhoneDoingCount}}</span> 单,
                                                未接手: <span class="error">{{task.taskPhoneCount - task.taskPhoneDoingCount - task.taskPhoneDoneCount}}</span> 单,
                                                已完成: <span class="error">{{task.taskPhoneDoneCount}}</span> 单
                                            </p>
                                            <p>商品搜索关键词</p>
                                            淘宝搜索关键词：
                                                <span ng-if="task.taobaoKey1">
                                                {{task.taobaoKey1}}
                                                流量:
                                                {{task.taskPV / task.taobaoKeyCount1 | number: 0}}
                                                <br/>
                                                </span>
                                                <span ng-if="task.taobaoKey2">
                                                {{task.taobaoKey2}}
                                                流量:
                                                {{task.taskPV / task.taobaoKeyCount2 | number: 0}}
                                                <br/>
                                                </span>
                                                <span ng-if="task.taobaoKey3">
                                                {{task.taobaoKey3}}
                                                流量:
                                                {{task.taskPV / task.taobaoKeyCount3 | number: 0}}
                                                <br/>
                                                </span>
                                                <span ng-if="task.taobaoKey4">
                                                {{task.taobaoKey4}}
                                                流量:
                                                {{task.taskPV / task.taobaoKeyCount4 | number: 0}}
                                                <br/>
                                                </span>
                                                <span ng-if="task.taobaoKey5">
                                                {{task.taobaoKey5}}
                                                流量:
                                                {{task.taskPV / task.taobaoKeyCount5 | number: 0}}
                                                <br/>
                                                </span>
                                            </p>
                                            <p>天猫搜索关键词：
                                                <span ng-if="task.tmallKey1">
                                                {{task.tmallKey1}}
                                                流量:
                                                {{task.taskPV / task.tmallKeyCount1 | number: 0}}
                                                <br/>
                                                </span>
                                                <span ng-if="task.tmallKey2">
                                                {{task.tmallKey2}}
                                                流量:
                                                {{task.taskPV / task.tmallKeyCount2 | number: 0}}
                                                <br/>
                                                </span>
                                                <span ng-if="task.tmallKey3">
                                                {{task.tmallKey3}}
                                                流量:
                                                {{task.taskPV / task.tmallKeyCount3 | number: 0}}
                                                <br/>
                                                </span>
                                                <span ng-if="task.tmallKey4">
                                                {{task.tmallKey4}}
                                                流量:
                                                {{task.taskPV / task.tmallKeyCount4 | number: 0}}
                                                <br/>
                                                </span>
                                                <span ng-if="task.tmallKey5">
                                                {{task.tmallKey5}}
                                                流量:
                                                {{task.taskPV / task.tmallKeyCount5 | number: 0}}
                                                <br/>
                                                </span>
                                            </p>
                                        </div>
                                        <div class="border-bottom"></div>
                                        <div class="col-lg-12">
                                            <p>任务编号: {{task.taobaoTaskId || task.jdTaskId}}</p>
                                            <p>任务发布时间: {{task.taskCreateTime | date: 'yyyy-MM-dd HH:mm'}}</p>
                                            <p>店铺: {{task.taskShopName}}</p>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                        <div class="col-lg-8">
                            <section class="panel">
                                <header class="panel-heading">
                                    任务状态： {{statusMap.taskStatus[task.taskStatus]}}
                                </header>
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <p>
                                                您还可以：
                                                <button class="btn btn-warning" ng-if="task.taskStatus == 1 || task.taskStatus == 2 " ng-click="repeatTask(task)">修改任务</button>
                                                <button class="btn btn-warning" ng-click="cancelTask(task)">撤销任务</button>
                                            </p>
                                        </div>
                                        <div class="border-bottom"></div>
                                        <div class="col-lg-12">
                                            <p>平台返款冻结押金： <span class="error">{{task.taskTotalMoney}}</span>元</p>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
            </section>
        </section>
        <section class="panel">
            <header class="panel-heading">
                任务清单
            </header>
            <div class="panel-body">
                <div class="row">
                    <div class="col-lg-12">
                        <table class="table">
                            <thead>
                            <tr>
                                <th>买号</th>
                                <th>下单终端</th>
                                <th>订单号</th>
                                <th>快递信息</th>
                                <th>任务状态</th>
                                <th>退款金额</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="dotask in dotasks" ng-if="dotasks.length > 0">
                                <td>{{dotask.doTaskAccountName}}</td>
                                <td>{{dotask.doTaskTerminal=='pc'?'电脑端':'移动端'}}</td>
                                <td>
                                    <p>
                                        {{dotask.doTaskDetailOrderId}}
                                    </p>
                                    <p><a href="/seller/tasks/doTaskDetail?id={{dotask.doTaskDetailDoTaskId}}&taskId={{dotask.doTaskTaskId}}">查看详情</a></p>
                                </td>
                                <td>
                                    <p>
                                        {{dotask.doTaskExtendExpressName}}
                                    </p>
                                    <p>
                                        {{dotask.doTaskExtendExpressId}}
                                    </p>
                                </td>
                                <td>{{statusMap[dotask.doTaskStatus]}}</td>
                                <td>{{dotask.doTaskDetailOrderMoney}}</td>
                            </tr>
                            <tr ng-if="dotasks.length == 0">
                                <td colspan="6" style="text-align: center">暂无任务记录</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section class="panel">
            <header class="panel-heading">
                刷单商品
            </header>
            <div class="panel-body">
                <div class="row">
                    <div class="col-lg-12">
                        <table class="table">
                            <thead>
                            <tr>
                                <th>商品</th>
                                <th>单价</th>
                                <th>购买数量</th>
                                <th>小计</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>
                                    <img ng-src="{{task.taobaoImage || task.tmallImage || task.jdImage}}" alt="" width="50"/>
                                    <span class="error">
                                    {{task.taskName}}
                                    </span>
                                </td>
                                <td>
                                    {{task.taskMoney}}元
                                </td>
                                <td>
                                    {{task.taskCount}}
                                </td>
                                <td>{{task.taskMoney * task.taskCount}}元</td>
                            </tr>
                            <tr ng-if='task.extend1Name'>
                                <td>
                                    <img ng-src="{{task.extend1Image}}" alt="" width="50"/>
                                    <span class="error">
                                    {{task.extend1Name}}
                                    </span>
                                </td>
                                <td>
                                    {{task.extend1Money}}元
                                </td>
                                <td>
                                    {{task.extend1Count}}
                                </td>
                                <td>{{task.extend1Money * task.extend1Count }}元</td>
                            </tr>
                            <tr ng-if='task.extend2Name'>
                                <td>
                                    <img ng-src="{{task.extend2Image}}" alt="" width="50"/>
                                    <span class="error">
                                    {{task.extend2Name}}
                                    </span>
                                </td>
                                <td>
                                    {{task.extend2Money}}元
                                </td>
                                <td>
                                    {{task.extend2Count}}
                                </td>
                                <td>{{task.extend2Money * task.extend2Count }}元</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section class="panel">
            <header class="panel-heading">
                费用合计
            </header>
            <div class="panel-body">
                <table class="table table-striped table-advance table-hover">
                    <thead>
                    <tr>
                        <th>分类</th>
                        <th>费用明细</th>
                        <th>小计</th>
                        <th>合计</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>押金</td>
                        <td>
                            <p>商品1: {{item.money}}元 x {{item.count}}单</p>
                            <p ng-if="extendItem1.money">商品2: {{extendItem1.money}}元 x {{extendItem1.count}}单</p>
                            <p ng-if="extendItem2.money">商品3: {{extendItem2.money}}元 x {{extendItem2.count}}单</p>
                            <p ng-if="cost.promise != 0">运费保证金：{{cost.promise}}元/单</p>
                            <p>退款保障金: {{cost.totalMoney * 0.05 | number: 2}}元</p>
                        </td>
                        <td>{{cost.totalMoney * 1.05 + cost.promise | number: 2}}元</td>
                        <td>{{cost.totalMoney * 1.05 + cost.promise | number: 2}} x {{cost.totalCount}} = {{(cost.totalMoney * 1.05 + cost.promise) * cost.totalCount | number: 2}}元</td>
                    </tr>
                    <tr>
                        <td>一家币</td>
                        <td>套餐服务费：{{cost.fee * 1 + cost.transport * 1 | number: 2}}金币</td>
                        <td>{{cost.fee * 1 + cost.transport * 1 | number: 2}}金币 (快递服务费: {{cost.transport}} 金币)</td>
                        <td>{{cost.fee * 1 + cost.transport * 1 | number: 2}} x {{cost.totalCount}} = {{cost.totalFee + cost.transport * cost.totalCount | number:2}}金币</td>
                    </tr>
                    <tr>
                        <td>增值服务</td>
                        <td>
                            <p ng-show="cost.payback">押金直接返款: {{cost.payback | number:2}}金币</p>
                            <p ng-show="cost.speed">提升完成任务速度: {{cost.speed | number:2}}金币</p>
                            <p ng-show="cost.isExtendFee">加赏任务佣金: {{cost.extendFee * cost.totalCount | number:2}}金币</p>
                            <p ng-show="cost.isInterval">任务发布间隔: {{cost.interval | number:2}}金币</p>
                            <p ng-show="cost.cycleTime">延长买家购物周期: {{cost.cycleTime * cost.totalCount | number:2}}金币</p>
                            <p ng-show="cost.isGoodComment">优质好评: {{cost.goodCommentFee | number:2}}金币</p>
                            <p ng-show="cost.phone">手机端加成: {{cost.phone | number:2}}金币</p>
                        </td>
                        <td>--</td>
                        <td>{{cost.payback * 1 + cost.speed * 1 + (cost.isExtendFee?cost.extendFee * cost.totalCount:0) + (cost.isInterval?cost.interval:0) * 1 + (cost.cycleTime * 1) * (cost.totalCount * 1) + (cost.isGoodComment?cost.goodCommentFee * 1: 0) + cost.phone * 1 | number:2}}金币</td>
                    </tr>
                    <tr>
                        <td colspan="4"><span class="pull-right">
                                    费用合计 押金: {{(cost.totalMoney * 1.05 + cost.promise) * cost.totalCount | number: 2}} 元
                                    一家币: {{(cost.totalFee * 1 + cost.transport * cost.totalCount) + cost.payback * 1 + cost.speed * 1 + (cost.isExtendFee?cost.extendFee * cost.totalCount:0) + (cost.isInterval?cost.interval:0) * 1 + (cost.cycleTime * 1) * (cost.totalCount * 1) + (cost.isGoodComment?cost.goodCommentFee * 1: 0) + cost.phone * 1 | number:2}}金币
                                </span></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </section>

    </section>
    <a href="#myModal" data-toggle="modal" style="display: none" id="btn-add-extend-fee">一键加赏</a>
    <!-- Modal -->
    <div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">加赏任务</h4>
                </div>
                <div class="modal-body">
                    <p>请问您要加赏多少金币？</p>
                    <input ng-model="upTaskFeeCoin" type="text" placeholder="金币" autocomplete="off" class="form-control placeholder-no-fix">

                </div>
                <div class="modal-footer">
                    <button data-dismiss="modal" class="btn btn-default" id="btn-cancel" type="button">取消</button>
                    <button class="btn btn-info" ng-click="addExtendFee()" type="button">确定</button>
                </div>
            </div>
        </div>
    </div>
    <!-- modal -->
    <!--main content end-->
</section>
script:src
<% include ../common_footer.html %>
